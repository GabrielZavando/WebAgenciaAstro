---
import plansData from '../data/plans.json';

const plans = plansData.planes.map(plan => ({
  name: plan.nombre,
  description: plan.descripcion,
  price6: plan.precio_6_meses,
  price12: plan.precio_12_meses,
  features: Object.entries(plan.caracteristicas).map(([key, value]) => ({ key, value })),
  exclusions: Object.entries(plan.exclusiones).map(([key, value]) => ({ key, value }))
}));
---

<section class="plans" id="plans">
  <div class="plans__container">
    <h2 class="plans__title">Planes diseñados para tu crecimiento</h2>
    <p class="plans__subtitle">Elige el plan que mejor se adapte a tus necesidades</p>

    <div class="plans__grid">
      {plans.map(plan => (
        <div class="plan-card">
          <h3 class="plan-card__title">{plan.name}</h3>
          <p class="plan-card__description">{plan.description}</p>

          <div class="plan-card__price">
            <span class="price__amount">${plan.price6}</span>
            <span class="price__period">/6 meses</span>
            <span class="price__amount">${plan.price12}</span>
            <span class="price__period">/12 meses</span>
          </div>

          <ul class="plan-card__features">
            {plan.features.map(feature => (
              <li class="feature feature--included">
                <div class="feature__row">
                  <span class="feature__icon">{feature.key.split(' ')[0]}</span>
                  <span class="feature__name">{feature.key.replace(/^✔ |^✘ /, '')}</span>
                </div>
                <span class="feature__desc">{feature.value}</span>
              </li>
            ))}
          </ul>

          {plan.exclusions.length > 0 ? (
            <ul class="plan-card__exclusions">
              {plan.exclusions.map(exclusion => (
                <li class="feature feature--excluded">
                  <div class="feature__row">
                    <span class="feature__icon">{exclusion.key.split(' ')[0]}</span>
                    <span class="feature__name">{exclusion.key.replace(/^✔ |^✘ /, '')}</span>
                  </div>
                  <span class="feature__desc">{exclusion.value}</span>
                </li>
              ))}
            </ul>
          ) : null}

          <button class="plan-card__cta">Contratar ahora</button>
        </div>
      ))}
    </div>
  </div>
</section>

<style lang="scss">
    // Variables
    $color-primary: #FF0080;
    $color-secondary: #A600FF;
    $color-dark: #1D0033;
    $color-neutral: #2F2F2F;
    $color-white: #FFFFFF;
    $color-accent: #00FFE0;

    // Mixins
    @mixin responsive($breakpoint) {
        @if $breakpoint == tablet {
            @media (min-width: 768px) { @content; }
        } @else if $breakpoint == desktop {
            @media (min-width: 1024px) { @content; }
        }
    }

    .plans {
        padding: 4rem 1rem;
        background-color: #fafafa;

        &__container {
            max-width: 1200px;
            margin: 0 auto;
        }

        &__title {
            font-family: 'Montserrat', sans-serif;
            font-size: 2.25rem;
            font-weight: 700;
            text-align: center;
            color: $color-dark;
            margin-bottom: 1rem;
        }

        &__subtitle {
            font-family: 'Raleway', sans-serif;
            font-size: 1.125rem;
            text-align: center;
            color: $color-neutral;
            margin-bottom: 3rem;
        }

        &__grid {
            display: grid;
            gap: 2rem;
            
            @include responsive(tablet) {
                grid-template-columns: repeat(2, 1fr);
            }
            
            @include responsive(desktop) {
                grid-template-columns: repeat(3, 1fr);
            }
        }
    }

    .plan-card {
        background: $color-white;
        border-radius: 1rem;
        padding: 2rem;
        box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        position: relative;
        transition: transform 0.3s ease;

        &:hover {
            transform: translateY(-5px);
        }

        &--popular {
            border: 2px solid $color-primary;
        }

        &__badge {
            position: absolute;
            top: -12px;
            right: 1rem;
            background: $color-primary;
            color: $color-white;
            padding: 0.25rem 1rem;
            border-radius: 1rem;
            font-size: 0.875rem;
            font-weight: 600;
        }

        &__title {
            font-family: 'Montserrat', sans-serif;
            font-size: 1.5rem;
            font-weight: 700;
            color: $color-dark;
            margin-bottom: 0.5rem;
        }

        &__description {
            font-family: 'Raleway', sans-serif;
            color: $color-neutral;
            margin-bottom: 2rem;
        }

        &__price {
            text-align: center;
            margin-bottom: 2rem;

            .price__amount {
                font-size: 2.5rem;
                font-weight: 700;
                color: $color-primary;
            }

            .price__period {
                color: $color-neutral;
            }
        }

        &__features {
            list-style: none;
            padding: 0;
            margin-bottom: 2rem;

            .feature {
                display: block;
                margin-bottom: 0.75rem;
                color: $color-neutral;

                &__icon {
                    margin-right: 0.75rem;
                    font-size: 1.125rem;
                }

                &--included {
                    color: $color-dark;
                    .feature__icon {
                        color: $color-primary;
                    }
                }
            }
        }

        &__cta {
            width: 100%;
            padding: 1rem;
            border: none;
            border-radius: 0.5rem;
            background: $color-primary;
            color: $color-white;
            font-family: 'Montserrat', sans-serif;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease;

            &:hover {
                background: $color-secondary;
            }

            &:active {
                background: $color-dark;
            }
        }
    }

    .feature__row {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.25rem;
      border: none;
    }
</style>
